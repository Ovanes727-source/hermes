workflows:
  android-debug:
    name: Android Debug Build
    max_build_duration: 30
    environment:
      vars:
        PACKAGE_NAME: "com.example.hermes"
    scripts:
      - name: Setup and Build with Gradle
        script: |
          echo "üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è..."
          
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ Gradle
          echo "–î–æ—Å—Ç—É–ø–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ Gradle:"
          gradle --version || true
          
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞
          echo "üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:"
          ls -la
          echo ""
          echo "üìÅ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏:"
          find . -maxdepth 2 -type f -name "*.gradle*" | head -20
          
          echo "üöÄ –°–æ–±–∏—Ä–∞–µ–º –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É—è Gradle..."
          
          # –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Gradle
          if [ -f "build.gradle" ] || [ -f "build.gradle.kts" ]; then
            echo "üì¶ –ù–∞–π–¥–µ–Ω —Ñ–∞–π–ª build.gradle, –∏—Å–ø–æ–ª—å–∑—É–µ–º gradle –∫–æ–º–∞–Ω–¥—É..."
            gradle assembleDebug --stacktrace --info
          elif [ -f "app/build.gradle" ] || [ -f "app/build.gradle.kts" ]; then
            echo "üì¶ –ù–∞–π–¥–µ–Ω app/build.gradle, —Å–æ–±–∏—Ä–∞–µ–º –∏–∑ –∫–æ—Ä–Ω—è..."
            cd app
            gradle assembleDebug --stacktrace --info
          else
            echo "‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω build.gradle —Ñ–∞–π–ª!"
            echo "–ò—â–µ–º –≤—Å–µ gradle —Ñ–∞–π–ª—ã:"
            find . -name "*.gradle*" -type f
            exit 1
          fi
          
          if [ $? -eq 0 ]; then
            echo "‚úÖ –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞!"
          else
            echo "‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏!"
            exit 1
          fi
          
      - name: Find Artifacts
        script: |
          echo "üîç –ò—â–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–µ APK —Ñ–∞–π–ª—ã..."
          
          # –ò—â–µ–º –≤–æ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö
          find . -name "*.apk" -type f 2>/dev/null | while read apk; do
            echo "‚úÖ –ù–∞–π–¥–µ–Ω: $apk"
            ls -lh "$apk"
          done
          
          # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É build –ø–∞–ø–æ–∫
          echo ""
          echo "üìÅ –ü–∞–ø–∫–∏ —Å–±–æ—Ä–∫–∏:"
          find . -type d -name "build" | head -5 | while read dir; do
            echo "üìÇ $dir:"
            find "$dir" -name "*.apk" -type f | head -3
          done
          
    artifacts:
      - "**/build/outputs/apk/**/*.apk"
      - "**/build/outputs/**/*.apk"
      - "**/*.apk"
      
    publishing:
      email:
        recipients:
          - ovanes727@icloud.com
