workflows:
  android-debug:
    name: Android Debug Build
    max_build_duration: 30
    environment:
      vars:
        PACKAGE_NAME: "com.example.hermes"
    scripts:
      - name: Generate Gradle Wrapper
        script: |
          echo "üîß –°–æ–∑–¥–∞–µ–º Gradle Wrapper..."
          
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ gradle
          if command -v gradle &> /dev/null; then
            echo "‚úÖ Gradle –Ω–∞–π–¥–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ"
            
            # –°–æ–∑–¥–∞–µ–º wrapper –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
            if [ ! -f "./gradlew" ]; then
              echo "üì¶ –°–æ–∑–¥–∞–µ–º gradle wrapper..."
              gradle wrapper --gradle-version 8.5
              
              # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å–æ–∑–¥–∞–ª–æ—Å—å
              if [ -f "./gradlew" ]; then
                chmod +x ./gradlew
                echo "‚úÖ Gradle Wrapper —Å–æ–∑–¥–∞–Ω"
                ./gradlew --version
              else
                echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å gradle wrapper"
                # –ü—Ä–æ–±—É–µ–º –≤—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É
                mkdir -p gradle/wrapper
                cat > gradle/wrapper/gradle-wrapper.properties << 'EOF'
distributionBase=GRADLE_USER_HOME
distributionPath=wrapper/dists
distributionUrl=https\://services.gradle.org/distributions/gradle-8.5-bin.zip
zipStoreBase=GRADLE_USER_HOME
zipStorePath=wrapper/dists
EOF
                echo "‚úÖ gradle-wrapper.properties —Å–æ–∑–¥–∞–Ω"
              fi
            else
              echo "‚úÖ Gradle Wrapper —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
              chmod +x ./gradlew
            fi
          else
            echo "‚ùå Gradle –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ"
            exit 1
          fi
          
      - name: Build with Wrapper
        script: |
          echo "üöÄ –°–æ–±–∏—Ä–∞–µ–º –ø—Ä–æ–µ–∫—Ç..."
          
          if [ -f "./gradlew" ]; then
            ./gradlew assembleDebug --stacktrace --info
          elif [ -f "gradlew" ]; then
            chmod +x gradlew
            ./gradlew assembleDebug --stacktrace --info
          else
            echo "‚ùå Gradle Wrapper –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–π gradle"
            gradle assembleDebug --stacktrace --info
          fi
          
          if [ $? -eq 0 ]; then
            echo "‚úÖ –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞!"
          else
            echo "‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏!"
            exit 1
          fi
          
      - name: Collect Artifacts
        script: |
          echo "üì¶ –°–æ–±–∏—Ä–∞–µ–º –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã..."
          
          APK_COUNT=$(find . -name "*.apk" -type f 2>/dev/null | wc -l)
          echo "–ù–∞–π–¥–µ–Ω–æ APK —Ñ–∞–π–ª–æ–≤: $APK_COUNT"
          
          if [ $APK_COUNT -eq 0 ]; then
            echo "‚ö†Ô∏è APK –Ω–µ –Ω–∞–π–¥–µ–Ω—ã! –°—Ç—Ä—É–∫—Ç—É—Ä–∞ build:"
            find . -type d -name "build" | while read dir; do
              echo "üìÇ $dir:"
              find "$dir" -type f | head -10
            done
          else
            find . -name "*.apk" -type f | while read apk; do
              echo "üì± $apk ($(ls -lh "$apk" | awk '{print $5}'))"
            done
          fi
          
    artifacts:
      - "**/*.apk"
      
    publishing:
      email:
        recipients:
          - ovanes727@icloud.com
